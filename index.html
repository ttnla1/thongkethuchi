<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Bảng nhập dữ liệu</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f6f0fa;
      padding: 20px;
    }

    .form {
      display: grid;
      grid-template-columns: repeat(5, 1fr);
      gap: 10px;
      margin-bottom: 20px;
    }

    input, select, button {
      padding: 8px;
      font-size: 14px;
    }

    button {
      background: #8e7cc3;
      color: white;
      border: none;
      cursor: pointer;
      grid-column: span 5;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      background: white;
    }

    th, td {
      border: 1px solid #ccc;
      padding: 8px;
      text-align: center;
    }

    th {
      background: #8e7cc3;
      color: white;
    }

    .total {
      margin-top: 15px;
      font-weight: bold;
      text-align: right;
    }

    .delete {
      color: red;
      cursor: pointer;
    }
  </style>
</head>
<body>

  <h2>Nhập dữ liệu</h2>

  <div class="form">
    <input type="date" id="date">
    
    <select id="name">
      <option value="">-- Tên hàng --</option>
      <option value="Cá chạch lấu">Cá chạch lấu</option>
      <option value="Cá rô">Cá rô</option>
      <option value="Tôm">Tôm</option>
    </select>

    <input type="number" id="qty" placeholder="Số lượng" step="0.01">
    <input type="number" id="price" placeholder="Đơn giá">
    <input type="text" id="amount" placeholder="Thành tiền" disabled>

    <button onclick="addRow()">Thêm vào bảng</button>
  </div>

  <table>
    <thead>
      <tr>
        <th>Ngày</th>
        <th>Tên hàng</th>
        <th>Số lượng</th>
        <th>Đơn giá</th>
        <th>Thành tiền</th>
        <th>Xóa</th>
      </tr>
    </thead>
    <tbody id="tableBody">
      <tr id="empty">
        <td colspan="6">Chưa có dữ liệu</td>
      </tr>
    </tbody>
  </table>

  <div class="total">
    Tổng cộng: <span id="total">0</span> đ
  </div>

<script>
  const qty = document.getElementById("qty");
  const price = document.getElementById("price");
  const amount = document.getElementById("amount");
  const tbody = document.getElementById("tableBody");
  const totalEl = document.getElementById("total");

  // Tự tính thành tiền
  function calcAmount() {
    const q = parseFloat(qty.value) || 0;
    const p = parseFloat(price.value) || 0;
    amount.value = (q * p).toLocaleString();
  }

  qty.addEventListener("input", calcAmount);
  price.addEventListener("input", calcAmount);

  // Thêm dòng
  function addRow() {
    const date = document.getElementById("date").value;
    const name = document.getElementById("name").value;
    const q = parseFloat(qty.value);
    const p = parseFloat(price.value);

    if (!date || !name || !q || !p) {
      alert("Vui lòng nhập đầy đủ dữ liệu");
      return;
    }

    const money = q * p;

    if (document.getElementById("empty")) {
      document.getElementById("empty").remove();
    }

    const tr = document.createElement("tr");
    tr.innerHTML = `
      <td>${date}</td>
      <td>${name}</td>
      <td>${q}</td>
      <td>${p.toLocaleString()}</td>
      <td class="money">${money.toLocaleString()}</td>
      <td class="delete" onclick="deleteRow(this)">X</td>
    `;

    tbody.appendChild(tr);
    updateTotal();

    // reset form
    qty.value = "";
    price.value = "";
    amount.value = "";
  }

  // Xóa dòng
  function deleteRow(el) {
    el.parentElement.remove();
    updateTotal();

    if (tbody.children.length === 0) {
      tbody.innerHTML = `<tr id="empty"><td colspan="6">Chưa có dữ liệu</td></tr>`;
    }
  }

  // Tính tổng
  function updateTotal() {
    let sum = 0;
    document.querySelectorAll(".money").forEach(td => {
      sum += Number(td.textContent.replace(/,/g, ""));
    });
    totalEl.textContent = sum.toLocaleString();
  }
</script>

</body>
</html>
